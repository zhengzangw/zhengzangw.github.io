<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Math Miscellaneous | Zangwei</title>

    
    <link rel="stylesheet" href="/scss/main.min.db87d7b55e29b75699acf73451f98e37f7029321133dd8ae45930563c6c76609.css" integity="sha256-24fXtV4pt1aZrPc0UfmON/cCkyETPdiuRZMFY8bHZgk=">

    <script type="text/javascript" src="/js/dark.js"></script>
<script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>
</head><body class="app auto flex-container">
    <div class="flex-container flex-column"><nav>
    <hr>
    <div class="flex-container flex-row flex-row-full">
        
        <div class="nav-item">
            <a href="/about">[ About ]</a>
        </div>
        
        <div class="nav-item">
            <a href="/pdfs/resume.pdf">[ CV ]</a>
        </div>
        
        <div class="nav-item">
            <a href="/teach">[ Teaching ]</a>
        </div>
        
        <div class="nav-item">
            <a href="/notes">[ Notes ]</a>
        </div>
        
        <div class="nav-item">
            <a href="/friends">[ Friends ]</a>
        </div>
        
        <div class="nav-item btn btn-switch">
            <a>[ <span class="theme-name">Auto</span> ]</a>
        </div>
    </div>
    <hr>
</nav>
<div class="flex-passage flex-row flex-row-full">
            <div class="flex-column-20">
                <div class="return">
                    <a href=".."> RETURN </a>
                </div>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#gamma-function">Gamma Function</a></li>
    <li><a href="#riemann-zeta-function">Riemann Zeta Function</a></li>
  </ul>

  <ul>
    <li><a href="#关键代码">关键代码</a></li>
    <li><a href="#莫比乌斯反演">莫比乌斯反演</a>
      <ul>
        <li><a href="#关键代码-1">关键代码</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#正整数解">正整数解</a></li>
    <li><a href="#非负整数">非负整数</a></li>
    <li><a href="#最小限制">最小限制</a></li>
    <li><a href="#最大限制">最大限制</a></li>
  </ul>

  <ul>
    <li><a href="#用途">用途</a></li>
    <li><a href="#多项式与生成函数">多项式与生成函数</a></li>
  </ul>

  <ul>
    <li><a href="#积性函数求值">积性函数求值</a></li>
    <li><a href="#低于线性时间求和">低于线性时间求和</a></li>
  </ul>

  <ul>
    <li><a href="#莫比乌斯函数与容斥原理">****莫比乌斯函数与容斥原理</a></li>
  </ul>

  <ul>
    <li><a href="#积性函数的情况">积性函数的情况</a></li>
  </ul>

  <ul>
    <li><a href="#第一部分">第一部分</a></li>
    <li><a href="#第二部分">第二部分</a></li>
  </ul>

  <ul>
    <li><a href="#proof">Proof</a>
      <ul>
        <li><a href="#lemma">Lemma</a></li>
        <li><a href="#theorem">Theorem</a></li>
      </ul>
    </li>
    <li><a href="#algorithm">Algorithm</a></li>
    <li><a href="#code">Code</a></li>
  </ul>

  <ul>
    <li><a href="#proximal-mapping">proximal mapping</a></li>
    <li><a href="#proximal-gradient">proximal gradient</a></li>
  </ul>
</nav>
            </div>
            <main class="flex-column-80"><h1 id="特殊函数">特殊函数</h1>
<h2 id="gamma-function">Gamma Function</h2>
<ul>
<li>Gamma Function: $\Gamma(x)=\int^\infty_0e^{-t}t^{x-1}dt$</li>
<li>性质
<ul>
<li>$\Gamma(x+1)=x\Gamma(x)$</li>
<li>$\Gamma(n+1)=n!$</li>
<li>$\Gamma(\frac{1}{2})=\sqrt{\pi}$</li>
<li>$\Gamma(n+\frac{1}{2})=\frac{\sqrt\pi}{2^n}(2n-1)!!$</li>
<li>$\Gamma(\frac{1}{2}-n)=(-1)^n\frac{2^n\sqrt{\pi}}{(2n-1)}!!$</li>
</ul>
</li>
<li>$I_n=\int^\infty_0x^ne^{-x^2}dx=\frac{1}{2}\Gamma(\frac{n+1}{2})$</li>
<li>Guassian Integral: $\int_{-\infty}^{\infty}ae^{\frac{-(x-b)^2}{c^2}}=ac\sqrt{\pi}$</li>
</ul>
<h2 id="riemann-zeta-function">Riemann Zeta Function</h2>
<ul>
<li>$\zeta(z)=\sum_{n=1}^{\infty}\frac{1}{n^z}, Re(z)&gt;1$</li>
<li>$\zeta(z)=\frac{1}{1-2^{1-z}}\sum_{n=1}^\infty(-1)^{n+1}\frac{1}{n^z}, Re(z)&gt;0$</li>
<li>$\int^\infty_0\frac{x^{z-1}}{e^x\pm0}dx=\Gamma(z),z&gt;1$</li>
<li>$\int^\infty_0\frac{x^{z-1}}{e^x-1}dx=\Gamma(z)\zeta(z),z&gt;1$</li>
<li>$\int^\infty_0\frac{x^{z-1}}{e^x+1}dx=(1-2^{1-z})\Gamma(z)\zeta(z),z&gt;0$</li>
<li>$\zeta(0)=-\frac{1}{2}$</li>
<li>$\zeta(2)=\frac{\pi^2}{6}$</li>
</ul>
<h1 id="等价类">等价类</h1>
<ul>
<li>disjoint union: $\bigsqcup$</li>
<li>Cartesian product: $A\times B = {(a,b)|a\in A,b\in B}$</li>
<li>Equivalence relation:
<ul>
<li>$a\in A\rightarrow a\sim a$</li>
<li>$a\sim b\rightarrow b\sim a$</li>
<li>$a\sim b, b\sim c\rightarrow a\sim c$</li>
</ul>
</li>
<li>Equivalence class: $[a]={b\in A|b\sim a}$, $A=\bigsqcup_{a\in A}[a]$</li>
</ul>
<h1 id="区间互素">区间互素</h1>
<p>对于 a，在区间(1,n)中有多少与其互素的数？</p>
<p>令$A_i$表示(1..n)中素因子$p_i$的倍数。不互素的数即为$| \cup_iA_i |$</p>
<p>使用 mask 穷举所有可能，使用唯一 1 串判断存在元素</p>
<h2 id="关键代码">关键代码</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">    LL <span style="color:#a6e22e">work</span>(<span style="color:#66d9ef">int</span> a,<span style="color:#66d9ef">int</span> n){
        split(a,prime_of_n,len);
        LL mask <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>len,ans<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;</span>mask;<span style="color:#f92672">++</span>i){
            LL cnt <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, v<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span>len;<span style="color:#f92672">++</span>j)
                <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">&amp;</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;&lt;</span>j)){
                    cnt <span style="color:#f92672">++</span>;
                    v <span style="color:#f92672">*=</span> prime_of_n[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
                }
            <span style="color:#66d9ef">if</span> (cnt<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span>) ans<span style="color:#f92672">+=</span>n<span style="color:#f92672">/</span>v;
            <span style="color:#66d9ef">else</span> ans<span style="color:#f92672">-=</span>n<span style="color:#f92672">/</span>v;
        }
        <span style="color:#66d9ef">return</span> n<span style="color:#f92672">-</span>ans;
    }
</code></pre></div><h2 id="莫比乌斯反演">莫比乌斯反演</h2>
<p>令 f(k)= Num(gcd(x,y)==k),F(k) = Num(k|gcd(x,y)) = [A/d]*[B/d]
F(k) = $\sum_{k|d}f(d)$
得 f(k) = $\sum_{k|d}\mu(d/k)F(d)$</p>
<h3 id="关键代码-1">关键代码</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>b;<span style="color:#f92672">++</span>i) ans <span style="color:#f92672">+=</span> (LL)mu[i] <span style="color:#f92672">*</span> (b<span style="color:#f92672">/</span>i) <span style="color:#f92672">*</span> (d<span style="color:#f92672">/</span>i);
</code></pre></div><h1 id="不定方程的解">不定方程的解</h1>
<p>$$x_1+x_2+&hellip;+x_n = m$$</p>
<h2 id="正整数解">正整数解</h2>
<p>$$C_{m-1}^{n-1}$$</p>
<h2 id="非负整数">非负整数</h2>
<p>$$C_{m+n-1}^{n-1}$$</p>
<h2 id="最小限制">最小限制</h2>
<p>$$C_{m+n-\sum_{i=1}^{n}a_i-1}^{n-1}$$</p>
<h2 id="最大限制">最大限制</h2>
<p>当$b_i&gt;=m-n+1$时，解数为
$$C_{m-1}^{n-1}$$
当$b_i&lt;=m-n$时，解数为
$$C_{n+m+\sum_{i=1}^{n-1}b_i-1}^{n-1}$$</p>
<h1 id="最大值">最大值</h1>
<ul>
<li>无穷大: 0x7fffffff 32-bit int 最大值 2147483647 1e9</li>
<li>大值: 0x3f3f3f3f 1061109567 1e9</li>
<li>赋值无穷大: memset(a,0x3f,sizeof(a))</li>
</ul>
<h1 id="生成函数">生成函数</h1>
<p>称函数$G(x) = a_0 + a_1x + a_2x + &hellip;$ 为数列${a_n}$的生成函数。</p>
<h2 id="用途">用途</h2>
<ul>
<li>把组合问题的加法法则和幂级数的乘幂对应起来</li>
</ul>
<p>通用表达式为</p>
<!-- raw HTML omitted -->
<p>$$(x^{v[0]<em>n1[0]}+x^{v[0]</em>(n_1[0]+1)}+x^{v[0]*(n_1[0]+2)}+&hellip;+x^{v[0]<em>n_2[0])}$$
$$(x^{v[1]<em>n1[1]}+x^{v[1]</em>(n_1[1]+1)}+x^{v[1]</em>(n_1[1]+2)}+&hellip;+x^{v[1]<em>n_2[1])}$$
$$&hellip;$$
$$(x^{v[K]<em>n1[K]}+x^{v[K]</em>(n_1[K]+1)}+x^{v[K]</em>(n_1[K]+2)}+&hellip;+x^{v[K]*n_2[K])}$$</p>
<p>$K$对应具体问题中物品的种类数。<br>
$v[i]$表示该乘积表达式第 i 个因子的权重，对应于具体问题的每个物品的价值或者权重。<br>
$n_1[i]$表示该乘积表达式第 i 个因子的起始系数，对应于具体问题中的每个物品的最少个数，即最少要取多少个。<br>
$n_2[i]$表示该乘积表达式第 i 个因子的终止系数，对应于具体问题中的每个物品的最多个数，即最多要取多少个。<br>
系数 1 表示方案的贡献数</p>
<h2 id="多项式与生成函数">多项式与生成函数</h2>
<p>多项式可以看作是一个在其次数模意义下的生成函数。数列的卷积可以看作是多项式的乘法，继而使用多项式求逆等算法。</p>
<h1 id="积性函数">积性函数</h1>
<ol>
<li>[n/ab] = [[n/a]/n]; [n/ab] = [[n/a]/n]</li>
<li>[n/i] 只有$O(\sqrt{n})$种取值</li>
<li>狄利克雷卷积 $f*g$</li>
<li>积性函数
$e(x); I(x); id(x); \phi(x)$; $\mu(x)$<br>
$f_k(x) = \prod_ip_i^{[\frac{a_i}{k}]}$</li>
</ol>
<!-- raw HTML omitted -->
<h2 id="积性函数求值">积性函数求值</h2>
<ol>
<li>满足$i&lt;n,gcd(i,n)=d$的 i 共$\phi(n/i)$个</li>
<li>利用质因数分解，f(p^k)求 f(n)</li>
<li>利用狄利克雷卷积的交换律和结合律化简</li>
<li>积性函数前缀和：在欧拉筛过程中推出<em>O(n)求积性函数点值</em></li>
</ol>
<h2 id="低于线性时间求和">低于线性时间求和</h2>
<ol>
<li>[n/i] 只有$O(\sqrt{n})$种取值 （两个数组，一个存 f(1)-f($\sqrt n$),一个存 f(n/1)-f(n/$\sqrt n$)）
以下为 O($\sqrt n$)的穷举
for (int i=2;i&lt;=n;i=j+1){
j = n/(n/i);
}</li>
</ol>
<!-- raw HTML omitted -->
<h1 id="莫比乌斯反演-1">莫比乌斯反演</h1>
<h2 id="莫比乌斯函数与容斥原理">****莫比乌斯函数与容斥原理</h2>
<ul>
<li>$I*\phi = id$</li>
<li>$I*\mu = e$</li>
<li>$\mu * (1/n) = \phi/n$</li>
<li>$F = I<em>f \rightarrow f = \mu</em>F$</li>
<li>$I * f = \sum_{d|n}f(d)$</li>
<li>$\phi = I*\mu * \phi = \sum_{d|n}(\mu*\phi)$</li>
<li>$\sum_{d|gcd(a,b)} = \sum_{d|a,d|b}$</li>
</ul>
<h1 id="杜教筛">杜教筛</h1>
<p>求$S(n) = \sum_{i=1}^{n}f(i)$<br>
性质：h=f*g,则$\sum_{i=1}^{n}h(i)=\sum_i^ng(i)S([n/i])$<br>
得: g(1)S(n) = $\sum_{i=1}^nh(i)-\sum_2^ng(i)S([n/i])$<br>
O(1)计算 g(i)前缀和，O($\sqrt n$)计算$\sum_{i=1}^nh(i)$,时间复杂度为 O($n^\frac{3}{4}$)。<br>
若 f 为积性函数，先用欧拉筛求出前$n^\frac{2}{3}$项，更后面的项再递归。_O($n^\frac{2}{3}$)求积性函数前缀和_</p>
<h2 id="积性函数的情况">积性函数的情况</h2>
<ol>
<li>莫比乌斯函数</li>
<li>欧拉函数</li>
</ol>
<h1 id="extended-eratosthenes-sieve-或洲阁筛">Extended Eratosthenes Sieve （或洲阁筛）</h1>
<p>求$S(n) = \sum_{i=1}^{n}f(i)$, f(p)为关于 p 的多项式。_O($\frac{n^\frac{3}{4}}{logn}$)求积性函数前缀和_</p>
<p>和分两部分，是否有&gt;$\sqrt n$的质因子
$\sum_{i=1}^{n}F(i) = \sum_{1&lt;=1&lt;=n\newline no\ factors&gt;\sqrt n}F(i)(1+\sum_{\sqrt n&lt;=j&lt;=[\frac{n}{i}]\newline j\ is\ prime}F(j)$</p>
<h2 id="第一部分">第一部分</h2>
<p>$g_k(i,j)$: 前 i 个质数互质的数的 k 次幂和
$g_k(i,j)=g_k(i-1,j)-p^kg_k(i-1,[\frac{j}{p_i}])$
当$p_i^2&gt;j$时,$g_k(i,j)=g_k(i-1,j)-p^k$</p>
<h2 id="第二部分">第二部分</h2>
<p>f(i,j): 小于$\sqrt n$的后 i 个质数的和
$f(i,j)=f(i-1,j)+\sum_{c&gt;=1}F(p_i^c)f(i-1,[\frac{j}{p_i^c}])$
当$p_i^2&gt;j$时，$f(i,j)=f(i-1,j)+F(p_i)$</p>
<h1 id="rng58-clj-等式">rng58-clj 等式</h1>
<p>d(x)为 x 的约数个数
$$\sum_{i=1}^{a}\sum_{j=1}^{b}\sum_{k=1}^{c}d(ijk)=\sum_{gdc(i,j)=gcd(i,k)=gcd(j,k)=1}[\frac{a}{i}][\frac{b}{j}][\frac{c}{k}]$$</p>
<h1 id="lucas-theorem">Lucas Theorem</h1>
<p>$$\binom{n}{m} = \prod\binom{n_i}{m_i} (mod\ p)$$
where $n = \sum_{k=0}^{k} n_kp^k$ and $m = \sum_{k=0}^{k} m_kp^k$
If $n_i&lt;m_i$, $\binom{n_i}{m_i}$ = 0</p>
<h2 id="proof">Proof</h2>
<h3 id="lemma">Lemma</h3>
<p>For prime m and n, if 1&lt;=m&lt;=n-1, n|$\binom{n}{m}$</p>
<p>Thus $(1+x)^p = 1+x^p (mod\ p)$</p>
<p>With induction:
Suppose $(1+x)^{p^i} = 1 + x^{p^i} (mod\ p)$ for i&lt;=t then,
$(1+x)^{p^{t+1}} = (1+x^{p^i})^p = 1 + x^{p^{t+1}} (mod\ p)$</p>
<p>So $(1+X)^{p^i} = 1+X^{p^i} (mod\ p)$</p>
<h3 id="theorem">Theorem</h3>
<p>$$\sum_{n=0}^{m}\binom{m}{n}x^n \newline = (1+x)^m = \prod_{i=1}^{k}((1+x)^{p^i})^{m_i} \newline = \prod_{i=1}^{k} (1+x^{p^i})^{m_i} \newline = \prod_{i=1}^{k}(\sum_{n_i=0}^{m_i}\binom{m_i}{n_i}x^{n_ip^i}) = \prod_{i=1}^{k}(\sum_{n_i=0}^{p-1}\binom{m_i}{n_i}x^{n_ip^i}) \newline = \sum_{n=0}^{m}(\prod_{i=0}^{k}\binom{m_i}{n_i})x^n$$</p>
<h2 id="algorithm">Algorithm</h2>
<p>$O(log_pN)$</p>
<h2 id="code">Code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//O(log_p n) C_n^m
</span><span style="color:#75715e"></span>LL <span style="color:#a6e22e">lucas</span>(LL n,LL m,LL mod){
    <span style="color:#75715e">//mod is prime
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (n<span style="color:#f92672">&lt;</span>m) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (n<span style="color:#f92672">&lt;</span>p) <span style="color:#66d9ef">return</span> md(md(fac[n]<span style="color:#f92672">*</span>inv_fac[m])<span style="color:#f92672">*</span>inv_fac[n<span style="color:#f92672">-</span>m]);
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> md(<span style="color:#ae81ff">1ll</span><span style="color:#f92672">*</span>lucas(n<span style="color:#f92672">/</span>mod,m<span style="color:#f92672">/</span>mod,mod)<span style="color:#f92672">*</span>lucas(n<span style="color:#f92672">%</span>mod,m<span style="color:#f92672">%</span>mod,mod));
}
</code></pre></div><h1 id="逆元线性递推">逆元线性递推</h1>
<p>$[\frac{p}{i}]*i+(p%i) = 0 (\bmod p)\Rightarrow i^{-1} = -[\frac{p}{i}]*inv(p%i) (\bmod p)$</p>
<h2 id="proximal-mapping">proximal mapping</h2>
<ul>
<li>$\text{prox}<em>f(x)=\arg\min</em>{y\in U} f(y)+\frac{1}{2}||y-x||^2$</li>
</ul>
<!-- raw HTML omitted -->
<h2 id="proximal-gradient">proximal gradient</h2>
<ul>
<li>$\min f(x)=g(x)+h(x)$, $g(x)$ 凸且可导，$h(x)$ 可得 proximal 迭代算法， $x^k=\text{prox}_{t_kh}(x^{k-1}-t_k\nabla g(x^{k-1}))$</li>
</ul></main>
        </div>

    </div>
</body></html>